import { describe, it, vi } from 'vitest'

// TODO: https://vitest.dev/config/ **define import aliases in vitest config**
import { getTxMeta } from './tx-meta.js'
import type { Hex } from 'viem'

describe('txMeta', () => {
  it('runs and logs stuff', async () => {
    const txHash = '0xe73f658430c76c5dcf1f2c0421f434bbdcc9641b034cdaf152f3af3d69291ef2' as Hex

    const result = await getTxMeta(txHash)

    // console.log('txMeta result:', result)
  })
})

vi.mock('#app/client.js', () => {
  return {
    publicClient: {
      getTransaction: vi.fn(async () => ({
        blockHash: '0xf35eef3b7b60c4f86a35b0059262cd8eda6ea78d361d024079c9c300cf3317c7',
        blockNumber: 24036654n,
        from: '0x9f244f9316426030BCa51bAf35a4541422AB4f76',
        transactionIndex: 0,
        effectiveGasPrice: 86889n,
        accessList: [],
        chainId: 1337,
        gasLimit: 181247n,
        hash: '0xe73f658430c76c5dcf1f2c0421f434bbdcc9641b034cdaf152f3af3d69291ef2',
        input:
          '0x3bae3e7900000000000000000000000000000000000000000000000000000000000000000000000000000000000000009f244f9316426030bca51baf35a4541422ab4f7600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0bd89573edd265d3d9e0073f6d1e21e9df5e1da000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000007a1fe160277000000000000000000000000000097be8ff9065ce5f3d562cb6b458cde88c8307edf00000000000000000000000000000000000000000000000000000000693538f70000000000000000000000000000000000000000000000000000000069518b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001cec0d30239137514148d72d18a61fd9c04dca4fdfa0db36f44e716e399a060cb80d27bed9eb116d82d1e574c6a416801a4e5bbd7c4f44b0a434b45aa942a519cd',
        maxFeePerGas: 86897n,
        maxPriorityFeePerGas: 86881n,
        nonce: 34,
        r: '0xc69f8617cb4a7f58e087309dec7ce0556b0f1d1151a8707fdfc2b3093284f991',
        s: '0x70a82f9a4c42edab9c3cfcd01e24d1793d6c58a7bf7cbb607f1119dcc1d8528b',
        to: '0xa40E009b306B3b4f27374f6e833291DaAeC88cc6',
        type: 2,
        value: 0n,
        yParity: 0,
      })),
      getTransactionReceipt: vi.fn(async () => ({
        blockHash: '0xf35eef3b7b60c4f86a35b0059262cd8eda6ea78d361d024079c9c300cf3317c7',
        blockNumber: 24036654n,
        contractAddress: null,
        cumulativeGasUsed: 131220n,
        effectiveGasPrice: 86889n,
        from: '0x9f244f9316426030BCa51bAf35a4541422AB4f76',
        gasUsed: 131220n,
        logs: JSON.parse(
          '[{"address":"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000009f244f9316426030bca51baf35a4541422ab4f76","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x00000000000000000000000000000000000000000000000000138a388a43c000","blockHash":"0xf35eef3b7b60c4f86a35b0059262cd8eda6ea78d361d024079c9c300cf3317c7","blockNumber":"0x16ec52e","blockTimestamp":"0x69491031","transactionHash":"0xe73f658430c76c5dcf1f2c0421f434bbdcc9641b034cdaf152f3af3d69291ef2","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000009f244f9316426030bca51baf35a4541422ab4f76","0x00000000000000000000000097be8ff9065ce5f3d562cb6b458cde88c8307edf"],"data":"0x000000000000000000000000000000000000000000000000078e73dd78334000","blockHash":"0xf35eef3b7b60c4f86a35b0059262cd8eda6ea78d361d024079c9c300cf3317c7","blockNumber":"0x16ec52e","blockTimestamp":"0x69491031","transactionHash":"0xe73f658430c76c5dcf1f2c0421f434bbdcc9641b034cdaf152f3af3d69291ef2","transactionIndex":"0x0","logIndex":"0x1","removed":false},{"address":"0xc0bd89573edd265d3d9e0073f6d1e21e9df5e1da","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000097be8ff9065ce5f3d562cb6b458cde88c8307edf","0x0000000000000000000000009f244f9316426030bca51baf35a4541422ab4f76","0x000000000000000000000000000000000000000000000000000000000000000e"],"data":"0x","blockHash":"0xf35eef3b7b60c4f86a35b0059262cd8eda6ea78d361d024079c9c300cf3317c7","blockNumber":"0x16ec52e","blockTimestamp":"0x69491031","transactionHash":"0xe73f658430c76c5dcf1f2c0421f434bbdcc9641b034cdaf152f3af3d69291ef2","transactionIndex":"0x0","logIndex":"0x2","removed":false},{"address":"0xa40e009b306b3b4f27374f6e833291daaec88cc6","topics":["0xc0ac3eb1e8caef05b202043f34de8e3173fab712167584f7a2a9f4c302bd0e9c","0x17e817fc6be7fc69301a81fa02eb75dab6ba3652d0e10a28852d9ade723fce3f","0x000000000000000000000000c0bd89573edd265d3d9e0073f6d1e21e9df5e1da","0x000000000000000000000000000000000000000000000000000000000000000e"],"data":"0x00000000000000000000000097be8ff9065ce5f3d562cb6b458cde88c8307edf0000000000000000000000009f244f9316426030bca51baf35a4541422ab4f76000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000007a1fe1602770000","blockHash":"0xf35eef3b7b60c4f86a35b0059262cd8eda6ea78d361d024079c9c300cf3317c7","blockNumber":"0x16ec52e","blockTimestamp":"0x69491031","transactionHash":"0xe73f658430c76c5dcf1f2c0421f434bbdcc9641b034cdaf152f3af3d69291ef2","transactionIndex":"0x0","logIndex":"0x3","removed":false}]'
        ),
        logsBloom:
          '0x000080000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000020000000c00000000000000001020000000400000000008000000080000000000000000000000000000000000000000000000000000000000000001000000000000040000000000000010180000000000000000000004000000000000000000280000000000000100000000000000000000000000000000000000000000000000400000000000a0100000000000000000000002000000200000000000000000200000002200100000000000000000002100300000000000000000000000000000000000000000000000000000000000',
        root: null,
        status: 1,
        transactionHash: '0xe73f658430c76c5dcf1f2c0421f434bbdcc9641b034cdaf152f3af3d69291ef2',
        transactionIndex: 0,
        type: 2,
        blobGasPrice: 1n,
        blobGasUsed: null,
        to: '0xa40E009b306B3b4f27374f6e833291DaAeC88cc6',
      })),
    },
  }
})
